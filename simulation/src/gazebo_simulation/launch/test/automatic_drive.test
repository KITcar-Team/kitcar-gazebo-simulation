<?xml version="1.0" encoding="UTF-8"?>
<launch>
  <arg name="speed" default="3" />
  <arg name="road" value="ci_roads/straight" />
  <arg name="time_limit" value="30" />

  <include file="$(find gazebo_simulation)/launch/master.launch">
    <arg name="road" value="$(arg road)" />
    <arg name="gui" value="false" />
    <arg name="include_brain" value="false" />
    <arg name="include_vehicle_simulation" value="false" />
    <arg name="include_mission_mode_plugin" value="false" />
  </include>

  <!-- Launch car_state_node -->
  <node name="automatic_drive" ns="simulation" pkg="gazebo_simulation" type="automatic_drive_node" output="screen">
    <param name="speed" value="$(arg speed)" />
    <rosparam file="$(find gazebo_simulation)/param/automatic_drive/test/default.yaml" command="load" />
    <rosparam file="$(find simulation_brain_link)/param/vehicle_simulation_link/default.yaml" command="load" ns="vehicle_simulation_link" />
    <rosparam file="$(find simulation_brain_link)/param/vehicle_simulation_link/topics.yaml" command="load" ns="topics/vehicle_simulation_link" />
    <rosparam file="$(find simulation_groundtruth)/param/groundtruth/topics.yaml" command="load" ns="topics/groundtruth" />
  </node>

  <test test-name="test_automatic_drive" pkg="gazebo_simulation" time-limit="$(arg time_limit)" type="test_automatic_drive">
    <rosparam file="$(find gazebo_simulation)/param/car_state/topics.yaml" command="load" ns="topics" />
  </test>

</launch>
